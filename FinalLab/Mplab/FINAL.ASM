LIST P=PIC18F452, F=INHX32, N=0, ST=OFF, R=HEX
config OSC=HS, OSCS=OFF, WDT=OFF, BORV=45, PWRT=ON, BOR=ON, DEBUG=OFF, LVP=OFF, STVR=OFF

#INCLUDE <P18F452.INC>

ORG 00H 
MOVLW 00H
MOVWF 32H

LCD_DATA EQU PORTD
LCD_CTRL EQU PORTC
RS EQU RC0
RW EQU RC1
EN EQU RC2



BCF TRISC,0
BCF TRISC,1
BCF TRISC,2 

CLRF TRISD

MOVLW 01H
MOVWF 30H

BCF LCD_CTRL,EN
CALL DELAY
MOVLW 0X38;8BIT 2LINES
CALL COMWRT
CALL DELAY
MOVLW 0X0E;CURSON ON
CALL COMWRT
CALL DELAY
MOVLW 0X01
CALL COMWRT
CALL DELAY
MOVLW 0X06
CALL COMWRT
CALL DELAY

MOVLW 80H
CALL COMWRT
CALL DELAY

;TO GOTO 2ND LINE

;MOVLW 0C0H
;CALL COMWRT
;CALL SSDELAY
;
;TO CLEAR LCD
;MOVLW 0X01
;CALL COMWRT
;CALL SSDELAY

;LCD VARIABLES SETTING END
MOVLW 0X01
CALL COMWRT
CALL SSDELAY

BSF TRISB,0
BSF TRISB,4

MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY

MOVLW A'G'
CALL DATAWRT
CALL SSDELAY
MOVLW A'R'
CALL DATAWRT
CALL SSDELAY
MOVLW A'O'
CALL DATAWRT
CALL SSDELAY
MOVLW A'U'
CALL DATAWRT
CALL SSDELAY
MOVLW A'P'
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY

MOVLW A'#'
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A'0'
CALL DATAWRT
CALL SSDELAY
MOVLW A'1'
CALL DATAWRT
CALL SSDELAY
; NOW MOVE TO 2ND LINE
MOVLW 0C0H
CALL COMWRT
CALL SSDELAY


MOVLW A' '
CALL DATAWRT
CALL SSDELAY

MOVLW A' '
CALL DATAWRT
CALL SSDELAY

MOVLW A'F'
CALL DATAWRT
CALL SSDELAY
MOVLW A'I'
CALL DATAWRT
CALL SSDELAY
MOVLW A'N'
CALL DATAWRT
CALL SSDELAY
MOVLW A'A'
CALL DATAWRT
CALL SSDELAY
MOVLW A'L'
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A'P'
CALL DATAWRT
CALL SSDELAY
MOVLW A'R'
CALL DATAWRT
CALL SSDELAY
MOVLW A'O'
CALL DATAWRT
CALL SSDELAY
MOVLW A'J'
CALL DATAWRT
CALL SSDELAY
MOVLW A'E'
CALL DATAWRT
CALL SSDELAY
MOVLW A'C'
CALL DATAWRT
CALL SSDELAY
MOVLW A'T'
CALL DATAWRT
CALL SSDELAY




LOOP1 BTFSS PORTB,0
BRA LOOP1

MOVLW 0X01
CALL COMWRT
CALL SSDELAY

MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A'P'
CALL DATAWRT
CALL SSDELAY
MOVLW A'E'
CALL DATAWRT
CALL SSDELAY
MOVLW A'R'
CALL DATAWRT
CALL SSDELAY
MOVLW A'S'
CALL DATAWRT
CALL SSDELAY
MOVLW A'O'
CALL DATAWRT
CALL SSDELAY
MOVLW A'N'
CALL DATAWRT
CALL SSDELAY 
MOVLW A' '
CALL DATAWRT
CALL SSDELAY

MOVLW A'E'
CALL DATAWRT
CALL SSDELAY
MOVLW A'N'
CALL DATAWRT
CALL SSDELAY
MOVLW A'T'
CALL DATAWRT
CALL SSDELAY
MOVLW A'E'
CALL DATAWRT
CALL SSDELAY
MOVLW A'R'
CALL DATAWRT
CALL SSDELAY
MOVLW A'E'
CALL DATAWRT
CALL SSDELAY
MOVLW A'D'
CALL DATAWRT
CALL SSDELAY



MOVLW 07H
MOVWF T0CON

DELAYYY BTFSC PORTB,4
BRA PRINTT

MOVLW 0F0H
MOVWF TMR0H

MOVLW 0BEH
MOVWF TMR0L
;
;
BCF INTCON,TMR0IF
;
BSF T0CON,TMR0ON
;
TEST1 BTFSS INTCON,TMR0IF
BRA TEST1
BCF T0CON,TMR0ON

MOVLW D'59' ;TO COMPARE IF OUR COUNT IS LESS THAN 60 OR NOT
CPFSLT 32H
BRA MINUTE
INCF 32H
BRA DELAYYY

MINUTE
CLRF 32H
MOVLW D'59'
CPFSLT 33H
BRA HOUR
INCF 33H
BRA DELAYYY

HOUR
CLRF 33H
INCF 34H
BRA DELAYYY



PRINTT

MOVLW 0X01
CALL COMWRT
CALL SSDELAY

MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY

MOVF 34H,W ; HOURS
CALL H2A

MOVLW A':'
CALL DATAWRT
CALL SSDELAY


MOVF 33H,W ;MINUTES
CALL H2A

MOVLW A':'
CALL DATAWRT
CALL SSDELAY


MOVF 32H,W ; SECONDS
CALL H2A

MOVLW 0C0H
CALL COMWRT
CALL SSDELAY


MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY
MOVLW A' '
CALL DATAWRT
CALL SSDELAY

MOVLW A'H'
CALL DATAWRT
CALL SSDELAY
MOVLW A'H'
CALL DATAWRT
CALL SSDELAY
MOVLW A':'
CALL DATAWRT
CALL SSDELAY
MOVLW A'M'
CALL DATAWRT
CALL SSDELAY
MOVLW A'M'
CALL DATAWRT
CALL SSDELAY
MOVLW A':'
CALL DATAWRT
CALL SSDELAY
MOVLW A'S'
CALL DATAWRT
CALL SSDELAY
MOVLW A'S'
CALL DATAWRT
CALL SSDELAY



GOTO stuck


;modified at 6:41am 28-12-2018

stuck
;;BTFSS PORTC,5
;;BRA ENDO
;BTFSS PORTB,0 ;if using push button as reset
BRA stuck
;BRA AGAIN

;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;
;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  FUNCTIONS CALL  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;
;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;

DELAYY
BCF T0CON,TMR0ON
MOVLW 0F0H
MOVWF TMR0H 
MOVLW 0BDH
MOVWF TMR0L
BSF T0CON,TMR0ON
ABCD BTFSS INTCON,TMR0IF
BRA ABCD

RETURN


;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%;

;FOR LCD DISPLAYING;

COMWRT
MOVWF LCD_DATA
BCF LCD_CTRL,RS ;AS COMMAND MODE SELECT REGISTER = 0
BCF LCD_CTRL,RW ; AS OUTPUT WRITE MODE IN LCD
BSF LCD_CTRL,EN ;ENABLER PIN
CALL DELAY
BCF LCD_CTRL,EN

RETURN

DATAWRT
MOVWF LCD_DATA
BSF LCD_CTRL,RS ;AS DATA MODE SELECT REGISTER =1
BCF LCD_CTRL,RW ; AS OUTPUT WRITE MODE IN LCD
BSF LCD_CTRL,EN ;ENABLER PIN
CALL DELAY
BCF LCD_CTRL,EN

RETURN

DELAY
MOVLW 08H
MOVWF T0CON
MOVLW 3CH
MOVWF TMR0H
MOVLW 0B0H
MOVWF TMR0L
BCF INTCON,TMR0IF
BSF T0CON,7
BA BTFSS INTCON,TMR0IF
BRA BA
BCF T0CON,7


RETURN


H2A

MOVWF 35H ;JO NUMBER CONVERT KARNA HAI;
movlw 0Ah ; 10
movwf 55h

CPFSLT 35H
BRA GREATER
MOVLW 30H
ADDWF 35H

MOVLW 30H
CALL DATAWRT
CALL DELAY

MOVF 35H,W
CALL DATAWRT
CALL DELAY

RETURN
GREATER

;BITS KO ALAG KARNA HAI:

;DIV 

MOVLW 00H
MOVWF 07H
MOVFF 35H,36H
MOVLW 0AH

DIVLOOP INCF 07H
SUBWF 36H,F
BNN DIVLOOP
DECF 07H
ADDWF 36H,F ;REMAINDER

;36H CONTAINS REMAINDER
;07H CONTAINS QUOTIENT
MOVLW 30H
ADDWF 07H;;07 CONTAINS FIRST BIT OF TIMER
MOVF 07H,W
CALL DATAWRT
CALL SSDELAY

MOVLW 30H
ADDWF 36H;;07 CONTAINS 2ND BIT OF TIMER
MOVF 36H,W
CALL DATAWRT
CALL SSDELAY


RETURN

;MOVLW 40H
;ADDWF 35H
;MOVF 35H,W
;
;RETURN


;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



SDELAY ;15MS
MOVLW 08H
MOVWF T0CON
MOVLW 0C5H
MOVWF TMR0H
MOVLW 68H
MOVWF TMR0L
BCF INTCON,TMR0IF
BSF T0CON,7
BA2 BTFSS INTCON,TMR0IF
BRA BA2
BCF T0CON,7


RETURN


SSDELAY ;1MS
MOVLW 08H
MOVWF T0CON
MOVLW 0FCH
MOVWF TMR0H
MOVLW 18H
MOVWF TMR0L
BCF INTCON,TMR0IF
BSF T0CON,7
BA3 BTFSS INTCON,TMR0IF
BRA BA3
BCF T0CON,7


RETURN

end